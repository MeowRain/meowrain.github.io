# 一、机械臂的两大部分

常见机械臂的种类：

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_15-44-51.png"></div>

机械臂的两大部分分为感知部分和机械臂部分

## 1.1 感知部分

### 1.1.1 感知部分并不一定全是视觉

首先，感知部分并不一定全是视觉，根据不同的场景要求，可以有不同的方式实现感知部分，只不过视觉是最常用最通用的方式。

感知部分的核心任务就是获取物体坐标，因此只要可以获取物体坐标的方法都可以作为感知部分。比如采用触摸屏或压力屏，当物体放在屏幕的上面的时候通过电容电感或者压力的改变来获取物体的坐标，这样也可以实现感知部分的功能；或者，通过红外测距和传送带，当传送带传送物体到相应的距离范围内（红外测距），也可以获取物体的坐标，从而实现感知部分。

### 1.1.2 相机简介

分类：

* 普通USB相机：只能得到RGB信息，一般情况下只能获取二维信息，适用于相机固定且物体高度相差不大的场景

* 深度相机：还可以获得深度信息，即RGB-D，如Kinect,realsense等，可以直接获得像素点的三维坐标，适用于多种场合

### 1.2.3 如何在图像中找到物体（像素坐标（x,y））？

1. 通过特定形状和颜色
2. 建立三维模型（适用于模型简单的物体，效果最好） (通过OBK模型)
3. 动态追踪
4. 深度学习
5. 靠深度信息提取


## 1.2 机械臂部分

### 1.2.1 机械臂简介

机械臂的组成：机械臂机架+动力源+末端执行器+控制器（STM32、51等）组成

* 动力源：动力源是位置（角度）伺服的驱动器，常见的由舵机（通过PWM来控制角度）、步进电机（通过脉冲信号来控制旋转固定角度）和伺服电机（通过电压和电流来控制旋转固定的角度）。

* 末端执行器：末端执行器的种类有许多，一般末端执行器都是可以更换的，常见的末端执行器有夹爪和吸盘两种。

* 控制器： 驱动控制机械臂的机器，比如STM32和51等单片机，工业领域还有PLC。

### 1.2.2 机械臂的自由度

自由度：机械臂机架上有N个电机，就是N自由度机械臂，也叫N轴机械臂，记为N DOF。末端执行器上的不算做自由度。

某些商家将末端执行器上的电机也算做自由度，这其实是一种噱头，是一种偷换概念的行为，因为末端执行器上的电机一般只能控制末端执行器的开合等操作，但无法对机械臂整个姿态产生影响。

### 1.2.3 机械臂的正逆解

N个电机旋转的角度J={j1,j2,....,jN}，世界坐标系下的目标坐标(Xw,Yw,Zw),目标姿态（α，β，γ）

* 正解： 已知J，算出（Xw,Yw,Zw）与（α，β，γ）
* 逆解： 已知（Xw,Yw,Zw）与（α，β，γ）,算出J

#### 1.2.3.1 机械臂自由度与机械臂正逆结的关系

首先，以上式子可以当作方程组来看，总共可以划分为6个方程。即

    f1(j1)=Xw
    f2(j2)=Yw
    f3(j3)=Zw
    f4(j4)=α
    f5(j5)=β
    f6(j6)=γ

根据以上正逆解的原理可知，从N个电机旋转的角度J={j1,j2,...,jN}可知，一个机械臂有几个自由度，就意味着该机械臂的正逆解方程有几个未知数。

当一个机械臂有六个自由度的时候，也就意味着有6个变量，因此6自由度机械臂必定会存在有解的情况，因此六自由度存在一个特性即：理论上六自由度机械臂在任一空间中必会拥有最少一组解。

相应的，当机械臂自由度越少，则无解的情况下越多，因此机械臂自由度越少，则机械臂具有的姿态越少。以三自由度为例，三自由度机械臂一般情况只能实现水平抓取或者垂直抓取，其它更难的姿态则无法到达。

# 二、机械臂的两种控制方式

## 2.1 开环控制与闭环控制
两种控制方式为：开环控制和闭环控制

开环控制：感知部分得到物体坐标->控制机械臂末端执行器到达这个坐标

闭环控制：感知部分同时得到物体坐标与机械臂末端执行器坐标->控制机械臂末端执行器坐标与物体坐标两坐标重合

区别： 开环控制中机械臂末端执行器的坐标为机械臂正逆解得到（无反馈），而闭环中的末端执行器坐标为感知部分得到（有反馈）


## 2.2 机械臂控制的流程

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_15-59-11.png"></div>

其中姿态（α，β，γ）即为机械臂所需要旋转的角度。

由于机械臂到目标物体之间可以存在多种方式，因此根据环境与实际需求（有无障碍物、要求路径最短、要求时间最短等）会规划出一系列中间点。

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_16-06-02.png"></div>

# 三、机械臂正逆解原理

首先要搞清楚一个概念，以5m这个词为例，其有两层含义，第一层为一个东西长度为5m，第二层为移动了5m的距离，也就是5m既可以表示一种状态，也可以表示一种变换过程

同理,有如下公式：

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_19-53-38.png"></div>

其中式子R为姿态角度矩阵，p为位移矩阵

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_19-58-38.png"></div>

以该图为例，p(Xw,Yw,Zw)既可以表示P点的坐标，也可以表示各个坐标轴到达P点所要走的距离。此时p(Xw,Yw,Zw)既可以代表一个状态，也可以代表一个平移。

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-29-24.png"></div>

当A坐标系下的P点转移到B坐标系下的时候，只需要让P^A*T即可，因为T为一个变换矩阵，其中包括姿态角度变换和位移变换。

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-32-41.png"></div>

当从A坐标系下转移到C坐标系下的时候，存在公式：

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-35-28.png"></div>

## 3.1 正逆解方法

### 3.1.1 代数法
<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-36-43.png"></div>

上表DH表中，ai为两个关节之间偏移的参数，α1为两个关节之间角度偏移的参数，dj为两个关节之间的距离，θ为每个电机旋转的角度,init为每个电机的初始值

(i-1~i)T 表示从i-1坐标系下到i坐标系下的转换

只需要将DH表中的数据，代入到公式T当中，即可得到两个状态之间变换的关系

### 3.1.2 几何法

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-42-11.png"></div>

正解：根据机械臂旋转的角度即机械臂臂长，通过三角函数即可算出机械臂沿x轴和y轴移动的距离。

逆解：通过末端执行器的坐标，可反推出机械臂旋转的角度。

## 3.2 路径规划

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-45-34.png"></div>

## 3.3 如何得到物体在世界坐标系下物体的三维坐标？

<div><img src="https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/Snipaste_2024-12-19_20-49-33.png"></div>