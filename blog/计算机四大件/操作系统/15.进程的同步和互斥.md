![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/OperatingSystem/tbandhc.png)

# 一、进程同步

* 同步也称为直接制约关系。
* 在多道程序环境下，进程是并发执行的，不同进程之间存在着不同的相互制约关系。为了协调进程之间的相互制约关系,如等待、传递信息等，引入了进程同步的概念。进程同步是为了解决进程的异步问题。
* 一个简单的例子来理解这个概念。
* 例如，让系统计算1 + 2x3，假设系统产生两个进程: 一个是加法进程，一个是乘法进程。要让计算结果是正确的，一定要让加法进程发生在乘法进程之后,但实际上操作系统具有异步性,若不加以制约，加法进程发生在乘法进程之前是绝对有可能的，因此要制定一定的机制去约束加法进程，让它在乘法进程完成之后才发生。


        异步性：进程具有异步性的特征。异步性是指，各并发执行的进程以各自独立的、不可预知的速度向前推进。

# 二、进程互斥

* 互斥，亦称间接制约关系。进程互斥指当一个进程访问某临界资源时，另一个想要访问该临界资源的进程必须等待。当前访问临界资源的进程访问结束，释放该资源之后，另一个进程才能去访问临界资源。
* 在这里需复习一下临界资源的概念。
* 我们把一个时间段内只允许一个进程使用的资源称为临界资源。许多物理设备(比如摄像头、打印机)都属于临界资源。此外还有许多变量、数据、内存缓冲区等都属于临界资源。
* 对临界资源的访问，必须互斥地进行。

![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/OperatingSystem/huchifangwen.png)

* 为了禁止两个进程同时进入临界区，需遵循以下准则


![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/OperatingSystem/huchifw.png)

空闲让进：空闲状态允许进入临界区

忙则等待：临界区已经有了其它进程，需要在外等待

有限等待：应该保证在有限时间内可以进入临界区（不要一直敲门）

让权等待：不能进入临界区，就立刻释放处理机，防止进程等待


# 总结

同步就是一前一后，而互斥则是只能有一个进程访问临界资源

以多生产者-多消费者问题举例

在分析同步问题（一前一后问题）的时候不能从单个进程行为的角度来分析，要把“一前一后”发生的事看做两种“事件”的前后关系。

比如，如果从单个进程行为来考虑的话，我们会有如下结论：

如果盘子里面装有苹果，那么一定要女儿取走苹果后父亲或母亲才能再放入水果

如果盘子里面装有橘子，那么一定要儿子取走橘子后父亲或母亲才能再放入水果

这么看是否就意味着要设置四个同步信号量分别实现这四个“一前一后”的关系了？ 当然不对

正确的分析方法应该是从“事件”的角度来考虑，我们可以把上述四对“进程行为的前后关系”抽象为一对“事件的前后关系”

盘子变空事件->放入水果事件。“盘子变空事件”既可由儿子触发，也可由女儿触发：“放水果事件”既可能是父亲执行，也可能是母亲执行。这样的话，就可以用一个同步信号量解决问题了。

<font color="red">在面对信号量问题的时候，视角不应该局限在一个进程上，而应多个进程协同来看，进程具有异步性，每个进程中的每个语句都有被执行的可能，因此必须一起来看。</font>

