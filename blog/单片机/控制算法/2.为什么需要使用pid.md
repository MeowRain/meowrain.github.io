# 一、减小电池电压随时间而下降所带来的影响

以小车速度为例，你一定会发现这样一个问题，当你刚把充满的12V电池装在小车上时，然后在程序上给了一个固定50%的占空比， 此时小车跑的很快动力很足，但是跑着跑着就慢了下来，因为电池电压的影响小车速度变慢了，在刚充满的时候12V电池50%的占空比 相当于直接作用在电机两端的电压是12V x 50% = 6V ,当使用一段时间后电池的电压变为9V，虽然程序占空比没有变，但是由于电池电压降低了， 所以作用在电机两端的电压也就变了，所以小车变慢了。那么怎么才能够使小车按照恒定速度行驶呢？其思想就是当小车速度慢了，就增加占空比。 那么速度慢多少开始增加占空比呢？怎么增加？增加多少呢？

此时，PID算法就是一个非常好的选择，对于增加多少的问题，一定要通过PID算法，因为速度和占空比到底是个什么关系，谁也不知道。 但是此时使用PID算法，通过编码器的速度反馈，可以实时的知道小车的速度是否慢了，然后利用目标速度与实际速度的误差带入算法， 即可获得当前占空比，达到控制速度的效果。

    众所周知，我们的电机驱动模型在假设输入量确定（为目标转速），输出量确定（PWM一定）时，系统的传递函数模型可以用一个表达式进行表征（这里看不懂的同学可以翻开控制工程看一下），并且该传递函数只和系统本身的特性有关。就好比输入x，传递函数就是y=2x，输出的自然就是2x了。但是，实际情况下输入量和系统都会有一个干扰量，输入电压也会波动，并且输入输出也并不完全成线性关系，这就导致了我们无法实际准确的表达传递函数，这会导致两点后果：第一，哪怕是同一型号规格，两个不同的电机在同PWM输出的时候转速是不同的；第二，同一个电机同PWM在不同路况下会受到干扰的影响，速度也是波动的。

    ​ 这就意味着我们用恒定PWM输出控制小车走直线的愿望破灭了。为了改善速度曲线，经典控制理论习惯使用添加串联校正或者反馈校正，但是刚才提到，我们的实际电机模型是未知的，明确的环节校正是比较困难的。我们联想，在数学中对于一条曲线，在某点附近可以用泰勒展开变成用一个多项式表述一段曲线，而在控制中也是类似，只不过这里的“多项式”变成了PID，即：比例环节，积分环节和微分环节（之所以选择这几个环节的原因参考传递函数的数学表达模型，同样参考控制工程）。

    ​ 在找宝物“pid调节圣器”之前，需要向当地的村民问路是一种常识，百度村的村民们都很热情，提供的资料多种多样，不过因为时间原因，村民们表述不清，个人能力不够等原因，很多资料都是过时的，错误的，甚至无法理解的。作为勇者的我们没有办法，只好拿着钱包抵……抱歉，串台了，只好拿着资料一点点学习对照，终于锁定了若干条有价值的情报：

