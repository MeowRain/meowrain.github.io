# 一、I2C总线简介

I2C总线是Philips公司在八十年代初推出的一种串行、半双工的总线，主要用于近距离、低速的芯片之间的通信；I2C总线有两根双向的信号线，一根数据线SDA用于收发数据，一根时钟线SCL用于通信双方时钟的同步；I2C总线硬件结构简单，简化了PCB布线，降低了系统成本，提高了系统可靠性，因此在各个领域得到了广泛应用。

I2C总线是一种多主机总线，连接在 I2C总线上的器件分为主机和从机。主机有权发起和结束一次通信，从机只能被动呼叫；当总线上有多个主机同时启用总线时，I2C也具备冲突检测和仲裁的功能来防止错误产生；每个连接到I2C总线上的器件都有一个唯一的地址（7bit），且每个器件都可以作为主机也可以作为从机（但同一时刻只能有一个主机），总线上的器件增加和删除不影响其他器件正常工作；I2C总线在通信时总线上发送数据的器件为发送器，接收数据的器件为接收器。

I2C总线可以通过外部连线进行在线检测，便于系统故障诊断和调试，故障可以立即被寻址，软件也有利于标准化和模块化，缩短开发时间。

I2C总线上可挂接的设备数量受总线的最大电容400pF限制。

串行的8位双向数据传输速率在标准模式下可达100Kbit/s，快速模式下可达400Kbit/s，高速模式下可达3.4Mbit/s。

总线具有极低的电流消耗，抗噪声干扰能力强，增加总线驱动器可以使总线电容扩大10倍，传输距离达到15m；兼容不同电压等级的器件，工作温度范围宽。

# 二、通信过程

1. 主机发送起始信号启用总线
2. 主机发送一个字节数据指明从机地址和后续字节的传送方向
3. 被寻址的从机发送应答信号回应主机
4. 发送器发送一个字节数据
5. 接收器发送应答信号回应发送器
6. ........ （循环步骤4、5）
7. 通信完成后主机发送停止信号释放总线

第4步和第5步用的是发送器和接收器，不是主机和从机，这是由第一个字节的最后一位决定主给从发，还是从给主发。

也就是说，第一个字节和最后的停止信号一定是主机发给从机，但中间就不一定了。

发送数据过程中不允许改变发送方向（除非重启一次通信，详见后文典型I2C时序(3)部分）。

# 三、寻址方式

I2C总线上传送的数据是广义的，既包括地址，又包括真正的数据。

主机在发送起始信号后必须先发送一个字节的数据，该数据的高7位为从机地址，最低位表示后续字节的传送方向，‘0’表示主机发送数据给->从机，‘1’表示从机发送数据给->主机。

总线上所有的从机接收到该字节数据后都将这7位地址与自己的地址进行比较，如果相同，则认为自己被主机寻址，然后再根据第8位将自己定为发送器或接收器。

# 四、起始信号和停止信号
SCL为高电平时，SDA由高变低表示起始信号；

SCL为高电平时，SDA由低变高表示停止信号；

起始信号和停止信号都是由主机发出，起始信号产生后总线处于占用状态，停止信号产生后总线被释放，处于空闲状态。

空闲时，SCL与SDA都是高电平，即SCL和SDA都被释放


![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/qsxhhtzxh.png)

 停止情况有两种：

1. 主机不想发了，就发送停止信号；
2. 从机不想接了，不应答，主机就发送停止信号结束此次通信。

# 五、字节传送与应答

I2C总线通信时每个字节为8位长度，数据传送时，先传送最高位，后传送低位，发送器发送完一个字节数据后接收器必须发送1位应答位来回应发送器，即一帧共有9位。

I2C每次发送数据必须是8位。

MSB固定，先发高位，再发低位。

![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/zjcshyd.png)

# 六、同步数据信号

I2C总线在进行数据传送时，时钟线SCL为低电平期间发送器向数据线上发送一位数据，在此期间数据线上的信号允许发生变化，时钟线SCL为高电平期间接收器从数据线上读取一位数据，在此期间数据线上的信号不允许发生变化，必须保持稳定。

![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/tbshujuxinh.png)


# 七、I2C时序

![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/zddzxi2csx.png)

![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/dqdzdI2Csx.png)

![](https://cdn.jsdelivr.net/gh/lcekold/blogimage@main/Network/zddzdI2Csx.png)



# 参考

<a href="https://blog.csdn.net/zhangduang_KHKW/article/details/121953275">I2C总线协议详解（特点、通信过程、典型I2C时序）</a>

